<!DOCTYPE html>
<html xmlns:th="http//www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml" xmlns="http://www.w3.org/1999/html"
      xmlns:width="http://www.w3.org/1999/xhtml"
      lang="en">
<head>
    <title>HDD | Personal Diary</title>
    <meta charset="utf-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
</head>
<body id="page2">
<div id="navbar" th:insert="navbar :: navbar"></div>
<div class="bg">
    <div class="container-fluid">
        <div class="container">
            <h4>Add new meal</h4>
            <br>
            <div class="row">
                <div class="col-md-8">
                    <form th:action="@{/personalDiary/meals}" method="POST" class="needs-validation" novalidate>
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                        <h3 th:text="${message}" th:style="#{message} != 0? 'color: red': 'color: red'"></h3>
                        <div class="row">
                            <div class="col-md-3">
                                <label for="inputDate">Date</label>
                                <input type="date" class="form-control" id="inputDate" placeholder="Date" name="date"
                                       aria-describedby="inputGroupPrepend" required>
                                <div class="invalid-feedback">
                                    Please enter date
                                </div>
                            </div>
                            <div class="col-md-3">
                                <label for="inputProduct">Product</label>
                                <input type="text" class="form-control" id="inputProduct" placeholder="Product name"
                                       name="productName" aria-describedby="inputGroupPrepend" required>
                                <div class="invalid-feedback">
                                    Please enter product
                                </div>
                            </div>
                            <div class="col-md-3">
                                <label for="inputWeight">Weight</label>
                                <input type="number" class="form-control" id="inputWeight"
                                       placeholder="Product weight(g)"
                                       name="weight" aria-describedby="inputGroupPrepend" required>
                                <div class="invalid-feedback">
                                    Please enter weight
                                </div>
                            </div>
                            <div class="col-md-2">
                                <button type="submit" class="btn btn-secondary mt-4 mb-3 mx-2">Save meal</button>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="col-md-4">
                    <form th:action="@{/personalDiary}" method="POST">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                        <div class="row">
                            <div class="col-md-6">
                                <label for="saveChangedDay">Choose changed day</label>
                                <input type="date" class="form-control" id="saveChangedDay" placeholder="Date" name="date"
                                       aria-describedby="inputGroupPrepend" required>
                                <div class="invalid-feedback">
                                    Please choose changed day
                                </div>
                            </div>
                            <div class="col-md-6">
                                <button type="submit" class="btn btn-success mt-4 mb-3 mx-2">Save Day Changes</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <hr>
        <hr>
    </div>
    <div class="container">
        <form method="GET">
            <div class="row">
                <div class="col-2">
                    <input type="date" class="form-control" id="date" placeholder="Date" name="date">
                </div>
                <div class="col-2">
                    <button type="submit" class="btn btn-secondary">Filter by Date</button>
                </div>
            </div>
        </form>
        <br>
        <h3>Daily Meals</h3>
        <div class="container">
            <table class="table table-striped">
                <thead>
                <tr>
                    <th scope="col">DATE</th>
                    <th scope="col">PRODUCT</th>
                    <th scope="col">WEIGHT(g)</th>
                    <th scope="col">CALORIES PER SERVING</th>
                    <th scope="col">ACTION</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="meal : ${meals}">
                    <td th:text="${meal.date}"></td>
                    <td th:each="product: ${meal.getProduct()}" th:text="${product.getProductName()}"></td>
                    <td th:text="${meal.weight}"></td>
                    <td th:text="${#numbers.formatDecimal(meal.caloriesPerServing, 1, 2)}"></td>
                    <td>
                        <a th:href="@{/personalDiary/meals/{id}(id = ${meal.id})}" role="button"
                           class="btn btn-secondary">edit weight</a>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
</div>
</section>
<footer>
</footer>
<script>
(function() {
  'use strict';
  window.addEventListener('load', function() {
    var forms = document.getElementsByClassName('needs-validation');
    var validation = Array.prototype.filter.call(forms, function(form) {
      form.addEventListener('submit', function(event) {
        if (form.checkValidity() === false) {
          event.preventDefault();
          event.stopPropagation();
        }
        form.classList.add('was-validated');
      }, false);
    });
  }, false);
})();
</script>
</body>
</html>
